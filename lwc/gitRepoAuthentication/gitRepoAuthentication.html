<template>
    <div>
        <div lwc:if={isLoading} class="authentication-spinner">
            <div class="slds-align_absolute-center">
                <lightning-spinner variant="brand" alternative-text={label.LOADING_DOT} size="large"> </lightning-spinner>
            </div>
        </div>

        <lightning-messages data-id="message"></lightning-messages>
        <lightning-card title={label.AUTHENTICATION_SETTINGS} icon-name="standard:apex_plugin">
            <template lwc:if={isNewMode}>
                <lightning-messages data-id="message"></lightning-messages>
                <c-copadocore-illustration lwc:if={illustrator} name="error:no_connection" size="large" message={label.Not_Authenticated}>
                    <div slot="body">
                        <div>{label.PLEASE_AUTHENTICATE_REPO}</div>
                        <div class="slds-var-m-top_large">
                            <ul class="auth-option-wrap">
                                <div class="auth-option">
                                    <button class={gitHubClass} onclick={handleProviderSelection} data-provider="github">
                                        <img src={githubLogoIcon} alt={label.GITHUB} /> {label.GITHUB}
                                    </button>
                                </div>
                                <div class="auth-option">
                                    <button class={gitLabClass} onclick={handleProviderSelection} data-provider="gitlab">
                                        <img src={gitlabLogoIcon} alt={label.GITLAB} /> {label.GITLAB}
                                    </button>
                                </div>
                                <div class="auth-option">
                                    <button class={onPremiseClass} onclick={handleProviderSelection} data-provider="onPremise">
                                        {label.ON_PREMISE_OR_MANUAL}
                                    </button>
                                </div>
                            </ul>

                            <div class="slds-var-m-top_medium">
                                <lightning-button
                                    variant="brand"
                                    label={label.AUTHENTICATE}
                                    onclick={openAuthenticateModal}
                                    disabled={isAuthenticationDisabled}
                                ></lightning-button>
                            </div>
                        </div>
                    </div>
                </c-copadocore-illustration>
                <div lwc:else class="auth-div-no-illustrator">
                    <div class="auth-div-no-illustrator">{label.PLEASE_AUTHENTICATE_REPO}</div>
                    <div class="slds-var-m-top_large">
                        <ul class="auth-option-wrap">
                            <div class="auth-option">
                                <button class={gitHubClass} onclick={handleProviderSelection} data-provider="github">
                                    <img src={githubLogoIcon} alt={label.GITHUB} /> {label.GITHUB}
                                </button>
                            </div>
                            <div class="auth-option">
                                <button class={gitLabClass} onclick={handleProviderSelection} data-provider="gitlab">
                                    <img src={gitlabLogoIcon} alt={label.GITLAB} /> {label.GITLAB}
                                </button>
                            </div>
                            <div class="auth-option">
                                <button class={onPremiseClass} onclick={handleProviderSelection} data-provider="onPremise">
                                    {label.ON_PREMISE_OR_MANUAL}
                                </button>
                            </div>
                        </ul>

                        <div class="slds-var-m-top_medium auth-div-no-illustrator">
                            <lightning-button
                                variant="brand"
                                label={label.AUTHENTICATE}
                                onclick={openAuthenticateModal}
                                disabled={isAuthenticationDisabled}
                            ></lightning-button>
                        </div>
                    </div>
                </div>
            </template>

            <template lwc:else>
                <lightning-button lwc:if={recordMode} label={label.EDIT} slot="actions" onclick={editAuthenticateModal}></lightning-button>
                <lightning-messages data-id="message"></lightning-messages>

                <div class="auth-form-wrap auth-form-wrap-view">
                    <div class="repository-info-wrap">
                        <div class="auth-form-wrap">
                            <div class="repository-info-wrap">
                                <h3 class="slds-section__title slds-theme_shade">
                                    <span class="slds-truncate slds-var-p-horizontal_small" title={label.REPO_INFORMATION}
                                        >{label.REPO_INFORMATION}</span
                                    >
                                </h3>

                                <lightning-record-view-form record-id={recordId} object-api-name={schema.GIT_REPOSITORY}>
                                    <lightning-layout multiple-rows>
                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="slds-form-element_readonly">
                                                <lightning-output-field
                                                    field-name={schema.GIT_PROVIDER_FIELD}
                                                    data-name={schema.GIT_PROVIDER_FIELD}
                                                ></lightning-output-field>
                                            </div>
                                        </lightning-layout-item>

                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="slds-form-element_readonly">
                                                <lightning-output-field field-name={schema.URI_FIELD} data-name="URI__c"></lightning-output-field>
                                            </div>
                                        </lightning-layout-item>

                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="slds-form-element_readonly">
                                                <lightning-output-field
                                                    field-name={schema.COMMIT_BASE_URL_FIELD}
                                                    data-name="commitBaseURL"
                                                ></lightning-output-field>
                                            </div>
                                        </lightning-layout-item>

                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="slds-form-element_readonly">
                                                <lightning-output-field field-name={schema.BRANCH_BASE_URL_FIELD} data-name="branchBaseURL">
                                                </lightning-output-field>
                                            </div>
                                        </lightning-layout-item>

                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="slds-form-element_readonly">
                                                <lightning-output-field
                                                    field-name={schema.PULL_REQUEST_BASE_URL_FIELD}
                                                    data-name="pullRequestBaseURL"
                                                ></lightning-output-field>
                                            </div>
                                        </lightning-layout-item>

                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="slds-form-element_readonly">
                                                <lightning-output-field
                                                    field-name={schema.TAG_BASE_URL_FIELD}
                                                    data-name="tagBaseURL"
                                                ></lightning-output-field>
                                            </div>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </lightning-record-view-form>
                            </div>
                        </div>
                    </div>

                    <div class="repository-auth-wrap">
                        <h3 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate slds-var-p-horizontal_small" title={label.REPO_AUTHENTICATION}
                                >{label.REPO_AUTHENTICATION}</span
                            >
                        </h3>
                        <lightning-layout multiple-rows>
                            <lightning-layout-item
                                size="12"
                                small-device-size="12"
                                medium-device-size="12"
                                large-device-size="6"
                                padding="around-small"
                            >
                                <div class="slds-form-element slds-form-element_readonly form-control-input">
                                    <div class="label-with-helptext">
                                        <label class="slds-form-element__label slds-no-flex">{label.AUTHENTICATION_TYPE}</label>
                                        <lightning-helptext content={label.AUTHENTICATION_TYPE_HELPTEXT}></lightning-helptext>
                                    </div>
                                    <div class="slds-form-element__control">
                                        <span class="slds-form-element__static slds-grow word-break-ie11">{authTypeReadOnly}</span>
                                    </div>
                                </div>
                            </lightning-layout-item>
                        </lightning-layout>

                        <template lwc:if={httpsFieldVisibleViewMode}>
                            <lightning-layout multiple-rows>
                                <lightning-layout-item
                                    size="12"
                                    small-device-size="12"
                                    medium-device-size="12"
                                    large-device-size="6"
                                    padding="around-small"
                                >
                                    <div class="slds-form-element slds-form-element_readonly form-control-input">
                                        <div class="label-with-helptext">
                                            <label class="slds-form-element__label slds-no-flex">{label.USERNAME}</label>
                                            <lightning-helptext content={label.USERNAME}> </lightning-helptext>
                                        </div>
                                        <div class="slds-form-element__control">
                                            <span class="slds-form-element__static slds-grow word-break-ie11">{userNameReadOnly}</span>
                                        </div>
                                    </div>
                                </lightning-layout-item>
                            </lightning-layout>
                        </template>
                        <template lwc:else>
                            <lightning-layout multiple-rows>
                                <template lwc:if={isSSHKeyVisible}>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="12"
                                        padding="around-small"
                                    >
                                        <div class="slds-form-element slds-form-element_readonly form-control-input">
                                            <div class="label-with-helptext">
                                                <label class="slds-form-element__label slds-no-flex">{label.SSH_KEY}</label>
                                            </div>
                                            <div class="slds-form-element__control">
                                                <span class="slds-form-element__static slds-grow word-break-ie11">{sshKey}</span>
                                            </div>
                                        </div>
                                    </lightning-layout-item>

                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="12"
                                        padding="around-small"
                                    >
                                        <template lwc:if={_attachmentId}>
                                            <lightning-button
                                                variant="base"
                                                label={label.COPY_TO_CLIPBOARD}
                                                title={label.COPY_TO_CLIPBOARD}
                                                icon-name="utility:copy_to_clipboard"
                                                class="slds-var-m-right_x-small"
                                                onclick={copyToClipboard}
                                            ></lightning-button>
                                            <lightning-button
                                                variant="base"
                                                label={label.RegenerateKey}
                                                title={label.RegenerateKey}
                                                icon-name="utility:refresh"
                                                class="slds-var-m-left_x-small"
                                                onclick={createSSHKey}
                                            ></lightning-button>
                                            <lightning-button
                                                icon-name="utility:delete"
                                                variant="base"
                                                alternative-text={label.DeleteKey}
                                                class="slds-text-color_error slds-var-m-left_x-small"
                                                title={label.DeleteKey}
                                                label={label.DeleteKey}
                                                onclick={deleteSSHKey}
                                            ></lightning-button>
                                        </template>
                                        <template lwc:else>
                                            <lightning-button
                                                variant="base"
                                                label={label.GenerateKey}
                                                onclick={createSSHKey}
                                                title={label.GenerateKey}
                                                icon-name="utility:refresh"
                                                class="slds-var-m-left_x-small"
                                            ></lightning-button>
                                        </template>
                                    </lightning-layout-item>
                                </template>
                                <lightning-layout-item
                                    size="12"
                                    small-device-size="12"
                                    medium-device-size="12"
                                    large-device-size="12"
                                    padding="around-small"
                                >
                                    <lightning-button-stateful
                                        class="ssh-key-button"
                                        variant="text"
                                        label-when-off={label.ShowSSHKey}
                                        label-when-on={label.HideSSHKey}
                                        icon-name-when-off="utility:preview"
                                        icon-name-when-on="utility:hide"
                                        selected={isSSHKeyVisible}
                                        onclick={keyToggleHandler}
                                    >
                                    </lightning-button-stateful>
                                </lightning-layout-item>
                            </lightning-layout>
                        </template>
                    </div>
                </div>
            </template>
        </lightning-card>

        <c-copadocore-modal size="medium" onmodalclose={closeModal}>
            <div lwc:if={isLoading} class="authentication-spinner">
                <div class="slds-align_absolute-center">
                    <lightning-spinner variant="Brand" alternative-text="Loading...." size="large"> </lightning-spinner>
                </div>
            </div>
            <span slot="title">{label.AUTHENTICATION_SETTINGS}</span>
            <slot>
                <lightning-record-edit-form
                    record-id={recordId}
                    object-api-name={schema.GIT_REPOSITORY}
                    onsubmit={validateFields}
                    onerror={handleError}
                >
                    <template lwc:if={isNewMode}>
                        <lightning-messages data-id="message"></lightning-messages>
                        <template lwc:if={errorMessage}>
                            <lightning-layout-item size="12">
                                <c-copado-scoped-notification variant="error" message={errorMessage}></c-copado-scoped-notification>
                            </lightning-layout-item>
                        </template>
                        <div class="auth-form-wrap">
                            <div class="repository-info-wrap">
                                <h3 class="slds-section__title slds-theme_shade">
                                    <span class="slds-truncate slds-var-p-horizontal_small" title={label.REPO_INFORMATION}
                                        >{label.REPO_INFORMATION}</span
                                    >
                                </h3>
                                <lightning-layout multiple-rows>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field
                                            field-name={schema.GIT_PROVIDER_FIELD}
                                            data-name={schema.GIT_PROVIDER_FIELD}
                                            required
                                            onchange={populateURLFields}
                                        >
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field field-name={schema.URI_FIELD} data-name="URI__c" required> </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field field-name={schema.COMMIT_BASE_URL_FIELD} data-name="commitBaseURL" required>
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field field-name={schema.BRANCH_BASE_URL_FIELD} data-name="branchBaseURL" required>
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field
                                            field-name={schema.PULL_REQUEST_BASE_URL_FIELD}
                                            data-name="pullRequestBaseURL"
                                            required
                                        >
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field field-name={schema.TAG_BASE_URL_FIELD} data-name="tagBaseURL" required>
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                </lightning-layout>
                            </div>
                            <div class="repository-auth-wrap">
                                <h3 class="slds-section__title slds-theme_shade">
                                    <span class="slds-truncate slds-var-p-horizontal_small" title={label.REPO_AUTHENTICATION}
                                        >{label.REPO_AUTHENTICATION}</span
                                    >
                                </h3>
                                <lightning-layout multiple-rows>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <div class="form-control-input">
                                            <div class="label-with-helptext">
                                                <label class="slds-form-element__label slds-no-flex">
                                                    <abbr class="slds-required" title="required">*</abbr>{label.AUTHENTICATION_TYPE}</label
                                                >
                                                <lightning-helptext content={label.AUTHENTICATION_TYPE_HELPTEXT}> </lightning-helptext>
                                            </div>
                                            <lightning-combobox
                                                data-section="repositoryAuth"
                                                name="authenticationType"
                                                variant="label-hidden"
                                                value="SSH"
                                                placeholder=""
                                                options={authenticationTypeOptions}
                                                onchange={handleAuthTypeChange}
                                                required
                                            ></lightning-combobox>
                                        </div>
                                    </lightning-layout-item>
                                    <template lwc:if={httpsFieldNotVisible}>
                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="12"
                                            padding="around-small"
                                        >
                                            <div class="form-control-input">
                                                <div class="label-with-helptext">
                                                    <label class="slds-form-element__label slds-no-flex"> {label.SSH_KEY}</label>
                                                    <lightning-helptext content={label.SSHKEY_HELPTEXT}> </lightning-helptext>
                                                </div>
                                                <lightning-textarea
                                                    data-section="repositoryAuth"
                                                    name="sshKey"
                                                    required
                                                    placeholder=""
                                                    value={sshKey}
                                                    variant="label-hidden"
                                                    readonly
                                                ></lightning-textarea>
                                            </div>
                                        </lightning-layout-item>
                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="12"
                                            padding="around-small"
                                        >
                                            <lightning-button
                                                variant="base"
                                                label={label.COPY_TO_CLIPBOARD}
                                                title={label.COPY_TO_CLIPBOARD}
                                                icon-name="utility:copy_to_clipboard"
                                                class="slds-var-m-right_x-small"
                                                onclick={copyToClipboard}
                                            ></lightning-button>
                                            <lightning-button
                                                variant="base"
                                                label={label.GenerateKey}
                                                title={label.GenerateKey}
                                                icon-name="utility:refresh"
                                                class="slds-var-m-left_x-small"
                                                onclick={createSSHKey}
                                            ></lightning-button>
                                        </lightning-layout-item>
                                    </template>
                                </lightning-layout>
                                <template lwc:if={httpsFieldVisible}>
                                    <lightning-layout multiple-rows>
                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="form-control-input">
                                                <div class="label-with-helptext">
                                                    <label class="slds-form-element__label slds-no-flex">
                                                        <abbr class="slds-required" title="required">*</abbr>{label.USERNAME}</label
                                                    >
                                                    <lightning-helptext content={label.USERNAME}></lightning-helptext>
                                                </div>
                                                <lightning-input
                                                    data-section="repositoryAuth"
                                                    name="repositoryAuthUserName"
                                                    type="text"
                                                    variant="label-hidden"
                                                    placeholder=""
                                                    required
                                                    value=""
                                                    onchange={handleUserNameChange}
                                                >
                                                </lightning-input>
                                            </div>
                                        </lightning-layout-item>
                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="form-control-input">
                                                <div class="label-with-helptext">
                                                    <label class="slds-form-element__label slds-no-flex">
                                                        <abbr class="slds-required" title="required">*</abbr>{label.PASSWORD}</label
                                                    >
                                                    <lightning-helptext content={label.PASSWORD}></lightning-helptext>
                                                </div>
                                                <lightning-input
                                                    data-section="repositoryAuth"
                                                    name="repositoryAuthPassword"
                                                    type="password"
                                                    variant="label-hidden"
                                                    placeholder=""
                                                    required
                                                    value=""
                                                    onchange={handlePasswordChange}
                                                >
                                                </lightning-input>
                                            </div>
                                        </lightning-layout-item>
                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="12"
                                            padding="around-small"
                                        >
                                            <div class="form-control-input">
                                                <div class="label-with-helptext">
                                                    <label class="slds-form-element__label slds-no-flex">{label.EXTRA_HEADERS}</label>
                                                    <lightning-helptext content="Extra Header"> </lightning-helptext>
                                                </div>
                                                <lightning-textarea
                                                    data-section="repositoryAuth"
                                                    name="extraHeader"
                                                    required
                                                    placeholder=""
                                                    variant="label-hidden"
                                                    onchange={handleHeaderChange}
                                                ></lightning-textarea>
                                            </div>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </template>
                            </div>
                        </div>
                    </template>
                    <template lwc:else>
                        <template lwc:if={errorMessage}>
                            <lightning-layout-item size="12">
                                <c-copado-scoped-notification variant="error" message={errorMessage}></c-copado-scoped-notification>
                            </lightning-layout-item>
                        </template>
                        <div class="auth-form-wrap">
                            <div class="repository-info-wrap">
                                <h3 class="slds-section__title slds-theme_shade">
                                    <span class="slds-truncate slds-var-p-horizontal_small" title={label.REPO_INFORMATION}
                                        >{label.REPO_INFORMATION}</span
                                    >
                                </h3>
                                <lightning-layout multiple-rows>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field
                                            field-name={schema.GIT_PROVIDER_FIELD}
                                            data-name={schema.GIT_PROVIDER_FIELD}
                                            required
                                            onchange={populateURLFields}
                                        >
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field field-name={schema.URI_FIELD} data-name="URI__c" required> </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field field-name={schema.COMMIT_BASE_URL_FIELD} data-name="commitBaseURL" required>
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field field-name={schema.BRANCH_BASE_URL_FIELD} data-name="branchBaseURL" required>
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field
                                            field-name={schema.PULL_REQUEST_BASE_URL_FIELD}
                                            data-name="pullRequestBaseURL"
                                            required
                                        >
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                    <lightning-layout-item
                                        size="12"
                                        small-device-size="12"
                                        medium-device-size="12"
                                        large-device-size="6"
                                        padding="around-small"
                                    >
                                        <lightning-input-field field-name={schema.TAG_BASE_URL_FIELD} data-name="tagBaseURL" required>
                                        </lightning-input-field>
                                    </lightning-layout-item>
                                </lightning-layout>
                                <div class="repository-auth-wrap">
                                    <h3 class="slds-section__title slds-theme_shade">
                                        <span class="slds-truncate slds-var-p-horizontal_small" title={label.REPO_AUTHENTICATION}
                                            >{label.REPO_AUTHENTICATION}</span
                                        >
                                    </h3>
                                    <lightning-layout multiple-rows>
                                        <lightning-layout-item
                                            size="12"
                                            small-device-size="12"
                                            medium-device-size="12"
                                            large-device-size="6"
                                            padding="around-small"
                                        >
                                            <div class="form-control-input">
                                                <div class="label-with-helptext">
                                                    <label class="slds-form-element__label slds-no-flex">
                                                        <abbr class="slds-required" title="required">*</abbr>{label.AUTHENTICATION_TYPE}</label
                                                    >
                                                    <lightning-helptext content={label.AUTHENTICATION_TYPE_HELPTEXT}> </lightning-helptext>
                                                </div>
                                                <lightning-combobox
                                                    data-section="repositoryAuth"
                                                    name="authenticationType"
                                                    variant="label-hidden"
                                                    value={authType}
                                                    placeholder=""
                                                    options={authenticationTypeOptions}
                                                    onchange={handleAuthTypeChange}
                                                    required
                                                ></lightning-combobox>
                                            </div>
                                        </lightning-layout-item>
                                        <template lwc:if={httpsFieldNotVisible}>
                                            <lightning-layout-item
                                                size="12"
                                                small-device-size="12"
                                                medium-device-size="12"
                                                large-device-size="12"
                                                padding="around-small"
                                            >
                                                <div class="form-control-input">
                                                    <div class="label-with-helptext">
                                                        <label class="slds-form-element__label slds-no-flex"> {label.SSH_KEY}</label>
                                                        <lightning-helptext content={label.SSHKEY_HELPTEXT}> </lightning-helptext>
                                                    </div>
                                                    <lightning-textarea
                                                        data-section="repositoryAuth"
                                                        name="sshKey"
                                                        placeholder=""
                                                        value={sshKey}
                                                        variant="label-hidden"
                                                        readonly
                                                        disabled
                                                    ></lightning-textarea>
                                                </div>
                                            </lightning-layout-item>
                                            <lightning-layout-item
                                                size="12"
                                                small-device-size="12"
                                                medium-device-size="12"
                                                large-device-size="12"
                                                padding="around-small"
                                            >
                                                <template lwc:if={_attachmentId}>
                                                    <lightning-button
                                                        variant="base"
                                                        label={label.COPY_TO_CLIPBOARD}
                                                        title={label.COPY_TO_CLIPBOARD}
                                                        icon-name="utility:copy_to_clipboard"
                                                        class="slds-var-m-right_x-small"
                                                        onclick={copyToClipboard}
                                                    ></lightning-button>
                                                    <lightning-button
                                                        variant="base"
                                                        label={label.RegenerateKey}
                                                        title={label.RegenerateKey}
                                                        icon-name="utility:refresh"
                                                        class="slds-var-m-left_x-small"
                                                        onclick={createSSHKey}
                                                    ></lightning-button>
                                                    <lightning-button
                                                        icon-name="utility:delete"
                                                        variant="base"
                                                        style="color: red"
                                                        alternative-text={label.DeleteKey}
                                                        class="slds-var-m-left_x-small"
                                                        title={label.DeleteKey}
                                                        label={label.DeleteKey}
                                                        onclick={deleteSSHKey}
                                                    ></lightning-button>
                                                </template>
                                                <template lwc:else>
                                                    <lightning-button
                                                        variant="base"
                                                        label={label.GenerateKey}
                                                        title={label.GenerateKey}
                                                        icon-name="utility:refresh"
                                                        class="slds-var-m-left_x-small"
                                                        onclick={createSSHKey}
                                                    ></lightning-button>
                                                </template>
                                            </lightning-layout-item>
                                        </template>
                                    </lightning-layout>
                                    <template lwc:if={httpsFieldVisible}>
                                        <lightning-layout multiple-rows>
                                            <lightning-layout-item
                                                size="12"
                                                small-device-size="12"
                                                medium-device-size="12"
                                                large-device-size="6"
                                                padding="around-small"
                                            >
                                                <div class="form-control-input">
                                                    <div class="label-with-helptext">
                                                        <label class="slds-form-element__label slds-no-flex">
                                                            <abbr class="slds-required" title="required">*</abbr>{label.USERNAME}</label
                                                        >
                                                        <lightning-helptext content={label.USERNAME}></lightning-helptext>
                                                    </div>
                                                    <lightning-input
                                                        data-section="repositoryAuth"
                                                        name="repositoryAuthUserName"
                                                        type="text"
                                                        variant="label-hidden"
                                                        placeholder=""
                                                        onchange={handleUserNameChange}
                                                        required
                                                        value={userName}
                                                    >
                                                    </lightning-input>
                                                </div>
                                            </lightning-layout-item>
                                            <lightning-layout-item
                                                size="12"
                                                small-device-size="12"
                                                medium-device-size="12"
                                                large-device-size="6"
                                                padding="around-small"
                                            >
                                                <div class="form-control-input">
                                                    <div class="label-with-helptext">
                                                        <label class="slds-form-element__label slds-no-flex">
                                                            <abbr class="slds-required" title="required">*</abbr>{label.PASSWORD}</label
                                                        >
                                                        <lightning-helptext content={label.PASSWORD}></lightning-helptext>
                                                    </div>
                                                    <lightning-input
                                                        data-section="repositoryAuth"
                                                        name="repositoryAuthPassword"
                                                        type="password"
                                                        variant="label-hidden"
                                                        placeholder=""
                                                        onchange={handlePasswordChange}
                                                        required
                                                        value={password}
                                                    >
                                                    </lightning-input>
                                                </div>
                                            </lightning-layout-item>
                                            <lightning-layout-item
                                                size="12"
                                                small-device-size="12"
                                                medium-device-size="12"
                                                large-device-size="12"
                                                padding="around-small"
                                            >
                                                <div class="form-control-input">
                                                    <div class="label-with-helptext">
                                                        <label class="slds-form-element__label slds-no-flex">{label.EXTRA_HEADERS}</label>
                                                        <lightning-helptext content={label.EXTRA_HEADERS}></lightning-helptext>
                                                    </div>
                                                    <lightning-textarea
                                                        data-section="repositoryAuth"
                                                        name="extraHeader"
                                                        placeholder=""
                                                        variant="label-hidden"
                                                        onchange={handleHeaderChange}
                                                        value={extraHeaders}
                                                    ></lightning-textarea>
                                                </div>
                                            </lightning-layout-item>
                                        </lightning-layout>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </template>
                </lightning-record-edit-form>
            </slot>

            <span slot="footer">
                <button class="slds-button slds-button_neutral" onclick={closeAuthenticateModal} title={label.Cancel}>{label.Cancel}</button>
                <button class="slds-button slds-button_brand" onclick={authenticateDetails} title={label.Save}>{label.Save}</button>
            </span>
        </c-copadocore-modal>

        <c-git-repo-selection-popup onsave={handleSelectRepository}></c-git-repo-selection-popup>
    </div>
</template>